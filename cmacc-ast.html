<!-- Imports polymer -->
<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-signals/iron-signals.html">
<link rel="import" href="../paper-tooltip/paper-tooltip.html">

<dom-module id="cmacc-ast">

</dom-module>


<script>

    Polymer({
        is: 'cmacc-ast',

        properties: {
            file: {
                type: String,
                observer: 'compose'
            },
            ast: {
                type: Object,
                notify: true
            }
        },

        compose: function (file) {
            var ast = window.cmacc.compile(file);
            console.log('AST', ast);
            this.set('ast', ast);
        },

        serialize: function () {
            return new Promise(function (resolve, reject) {
                window.cmacc.serialize(this.ast, function (err, source) {
                    if (err) return reject(err);
                    resolve(source)
                }.bind(this))
            }.bind(this))

        },

        find: function (key) {
            return window.cmacc.helper.queryAst(this.ast, key);
        }
    })
</script>